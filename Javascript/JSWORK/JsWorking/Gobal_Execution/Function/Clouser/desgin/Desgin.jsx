JS EXECUTION CONTEXT & CLOSURE
==============================

       CALL STACK                      HEAP MEMORY (Permanent)
+-----------------------+        +----------------------------------+
|                       |        |  ALLOCATION #0x77                |
|  count()  <-----------|--------|--> [ Function: inner ]           |
| (Running now)         |        |    [ Lexical Scope (Closure) ]   |
+-----------------------+        |    [ x: 10 ] <-------------------|--- "x" persists!
|  Global Context       |        |                                  |
+-----------------------+        +----------------------------------+
           |                                     ^
           |                                     |
           +-------------------------------------+
            (When outer() ran, it created this
             Heap object before disappearing)

Notes:
- Each call to outer() creates a **new closure** with its own `x`.
- Inner function retains reference to `x` via closure, even after outer() has finished.
- Global context only knows about the returned function.




========================================================================================
                                 JAVASCRIPT RUNTIME ARCHITECTURE
========================================================================================

    JS ENGINE (V8)                                       BROWSER / WEB APIs
   +---------------------------------------+            +------------------------------+
   |  CALL STACK (Last In, First Out)      |            |  1. Timers (setTimeout)      |
   |                                       |            |  2. Network (fetch/XHR)      |
   |  [ inner() ] <--- Current Execution   |            |  3. DOM Events (click)       |
   |  [ Global  ]                          |            |  4. Storage/IndexDB          |
   +------|--------------------------------+            +--------------|---------------+
          |                                                            |
          | (If Object/Closure)                                        | (When Finished)
          V                                                            V
   +---------------------------------------+            +------------------------------+
   |  HEAP MEMORY (The Warehouse)          |            |      TASK QUEUE POOL         |
   |                                       |            |                              |
   |  +---------------------------------+  |            |  +------------------------+  |
   |  | CLOSURE SCOPE (Persistent)      |  | <----------|  |  MICROTASK QUEUE (VIP) |  |
   |  | Variable x: 1                   |  |            |  |  - .then() callbacks   |  |
   |  +---------------------------------+  |            |  |  - await resumption    |  |
   |                                       |            |  +------------------------+  |
   |  +---------------------------------+  |            |               |              |
   |  | OBJECTS & FUNCTIONS             |  |            |  +------------------------+  |
   |  | - outer function code           |  |            |  |  MACROTASK QUEUE       |  |
   |  | - inner function code           |  |            |  |  - setTimeout callback |  |
   |  +---------------------------------+  |            |  |  - Event listeners     |  |
   +---------------------------------------+            |  +------------------------+  |
                                                        +------------------------------+
                                                                     |
                                      EVENT LOOP                     |
             +-------------------------------------------------------+
             |
             V
    [ THE CHECKING PHASE ]
    1. Is Call Stack Empty?  -----> (If No, Wait)
    2. Is Microtask Queue Empty? -> (If No, Run ALL Microtasks until empty)
    3. Run ONE Macrotask.
    4. Render UI / Repeat.
========================================================================================




Summary of the "Solve"
When you do const counter = outer(), the outer function is 
removed from the Stack, but the variable x is moved to a "Closure" 
box in the Heap. This is the only reason why calling counter() 
works laterâ€”it goes to the Heap to find x.


000000000000000000 ::::::::::::::::::: --------------------------------->>>

JS EXECUTION CONTEXT & CLOSURE
==============================

       CALL STACK                      HEAP MEMORY (Permanent)
+-----------------------+        +----------------------------------+
|                       |        |  ALLOCATION #0x77                |
|  inner()  <-----------|--------|--> [ Function: inner ]           |
| (Running now)         |        |    [ Lexical Scope (Closure) ]   |
+-----------------------+        |    [ x: 1 ] <--------------------|--- "x" persists!
|  Global Context       |        |                                  |
+-----------------------+        +----------------------------------+
           |                                     ^
           |                                     |
           +-------------------------------------+
            (When outer() ran, it created this
             Heap object before disappearing)



             CALL STACK                         HEAP MEMORY
   (Active Tasks)                   (Long-term Storage)
  +--------------+                +--------------------------+
  |              |                |  [ CLOSURE ]             |
  |  EMPTY       |                |  Variable x: 1  <-----+  |
  |              |                |                       |  |
  +--------------+                +-----------------------|--+
  | Global Exec  |                |  [ FUNCTION inner ]   |  |
  | Context      |                |  Code: "return x++" --+  |
  +--------------+                +--------------------------+
          |                                     ^
          |                                     |
          +--- counterVariable -----------------+
               (Points to the Heap)





â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            THE CLOSURE LIFECYCLE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 STEP 1: GLOBAL EXECUTION (Creation)
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ GLOBAL MEMORY     â”‚ counter: { f }  | inc: <uninitialized>                 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 STEP 2: const inc = counter()
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  CALL STACK       â”‚      â”‚   EXECUTION CONTEXT: counter()                 â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ counter()         â”‚â—„â”€â”€â”€â”€ â”‚ MEMORY: x = 1          â”‚ CODE: return fn       â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚ Global            â”‚         â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â–º [Inner function is born with a reference to x]

 STEP 3: inc() is called (The "Persistent Memory" Phase)
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  CALL STACK       â”‚      â”‚   EXECUTION CONTEXT: inc()                     â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ inc()             â”‚â—„â”€â”€â”€â”€ â”‚ MEMORY: (empty)        â”‚ CODE: return [[x]]++  â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚ Global            â”‚                  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   CLOSURE (The "Backpack") â”‚
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                          â”‚  x: 1  â”€â”€â–º becomes 2       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 FINAL OUTPUT:
 console.log(inc()) // Prints 1 (then x becomes 2)
 console.log(inc()) // Prints 2 (then x becomes 3)


 :::::::::::::::::::::: 0000000000000000000::

 ğŸ§© Example 4 â€” Heap + Closure (CRITICAL)

 function counter() {
  let x = 1
  return () => x++
}
const inc = counter()



STACK
inc â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â–¼
                 HEAP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ innerFunction               â”‚
â”‚ [[Scope]] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
               Lexical Env
               { x: 1 }
