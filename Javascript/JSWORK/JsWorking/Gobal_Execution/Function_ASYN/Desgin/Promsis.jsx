JS RUNTIME ARCHITECTURE
=======================

+-------------------------------------------------------------+
|  JS ENGINE (V8 / SpiderMonkey)                              |
|                                                             |
|  +-------------------+          +-----------------------+   |
|  |   MEMORY HEAP     |          |      CALL STACK       |   |
|  |  (Variables/Fn)   |          |  (Execution Context)  |   |
|  |                   |          |                       |   |
|  |  [Test Function]  |          |  1. Global Exec       |   |
|  |  [x: 14]          |          |  2. Test() <--- PAUSE |   |
|  +-------------------+          +----------|------------+   |
+--------------------------------------------|----------------+
       ^                                     |
       |                                     |  (await / .then)
       |          EVENT LOOP                 V
       |      +-----------------------------------------------+
       |      |             MICROTASK QUEUE (VIP)             |
       |      |  [1. then callback] [2. await continuation]   |
       |      +-----------------------------------------------+
       |                                     |
       |      +-----------------------------------------------+
       |      |             MACROTASK QUEUE                 |
       |      |  [setTimeout] [setInterval] [UI Events]       |
       +------|-----------------------------------------------+
                                     ^
                                     |
                          +-----------------------+
                          |       WEB APIs        |
                          | (Timer / Network / IO)|
                          +-----------------------+




                          +----------------------------------------------------------------+
|                     JS ENGINE (V8 / SpiderMonkey)               |
|                                                                |
|  +---------------------+        +---------------------------+  |
|  |     MEMORY HEAP     |        |        CALL STACK         |  |
|  |  (Objects / Fns)    |        |   (Execution Contexts)   |  |
|  |                     |        |                           |  |
|  |  [Test Function]    |        | 1. Global Exec            |  |
|  |                     |        | 2. Test()  â† paused      |  |
|  +---------------------+        +-------------|-------------+  |
+------------------------------------------------|----------------+
                                                     |
                                                     | (Event Loop)
                                                     v
            +----------------------------------------------------+
            |              MICROTASK QUEUE (HIGH PRIORITY)       |
            |  [Promise.then]  [await continuation]              |
            +---------------------------|------------------------+
                                        |
            +----------------------------------------------------+
            |              MACROTASK QUEUE                        |
            |  [setTimeout] [setInterval] [UI Events]            |
            +---------------------------|------------------------+
                                        ^
                                        |
                          +-------------------------------+
                          |           WEB APIs            |
                          |  Timers | Network | DOM | IO  |
                          +-------------------------------+
